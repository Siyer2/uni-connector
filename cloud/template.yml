AWSTemplateFormatVersion: '2010-09-09'
Transform: 'AWS::Serverless-2016-10-31'

Resources:
  # IAM Roles
  serverRole:
    Type: AWS::IAM::Role
    Properties:
      RoleName: serverRole
      Description: Role used by the Express server
      AssumeRolePolicyDocument:
        Version: 2012-10-17
        Statement:
          - Effect: Allow
            Principal:
              Service:
                - lambda.amazonaws.com
            Action:
              - 'sts:AssumeRole'
      Policies:
        - PolicyName: 'ReadWriteDynamoPolicy'
          PolicyDocument:
            Version: 2012-10-17
            Statement:
              - Effect: Allow
                Action:
                  - 'dynamodb:PutItem'
                  - 'dynamodb:ReadItem'
                  - 'dynamodb:GetItem'
                  - 'dynamodb:Scan'
                  - 'dynamodb:Query'
                Resource: '*'
  # End IAM Roles

  # userTable:
  #   Type: AWS::DynamoDB::Table
  #   Properties:
  #     AttributeDefinitions:
  #       - AttributeName: 'id'
  #         AttributeType: 'S'
  #       - AttributeName: 'faculty'
  #         AttributeType: 'S'
  #     KeySchema:
  #       - AttributeName: 'id'
  #         KeyType: 'HASH'
  #     ProvisionedThroughput:
  #       ReadCapacityUnits: '10'
  #       WriteCapacityUnits: '5'
  #     TableName: 'User'
  #     GlobalSecondaryIndexes:
  #       - IndexName: 'FacultyIndex'
  #         KeySchema:
  #           - AttributeName: 'faculty'
  #             KeyType: 'HASH'
  #         Projection:
  #           ProjectionType: 'ALL'
  #         ProvisionedThroughput:
  #           ReadCapacityUnits: '3'
  #           WriteCapacityUnits: '3'

  # matchHistoryTable:
  #   Type: AWS::DynamoDB::Table
  #   Properties:
  #     AttributeDefinitions:
  #       - AttributeName: 'user1ID'
  #         AttributeType: 'S'
  #       - AttributeName: 'date'
  #         AttributeType: 'S'
  #       - AttributeName: 'user2ID'
  #         AttributeType: 'S'
  #     KeySchema:
  #       - AttributeName: 'user1ID'
  #         KeyType: 'HASH'
  #       - AttributeName: 'date'
  #         KeyType: 'RANGE'
  #     ProvisionedThroughput:
  #       ReadCapacityUnits: '5'
  #       WriteCapacityUnits: '5'
  #     TableName: 'MatchHistory'
  #     LocalSecondaryIndexes:
  #       - IndexName: 'User2Index'
  #         KeySchema:
  #           - AttributeName: 'user1ID'
  #             KeyType: 'HASH'
  #           - AttributeName: 'user2ID'
  #             KeyType: 'RANGE'
  #         Projection:
  #           ProjectionType: 'ALL'
